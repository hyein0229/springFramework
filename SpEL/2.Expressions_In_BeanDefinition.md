# Expressions in Bean Definitions
- 빈 인스턴스를 정의하는 configuration 메타데이터에 SpEL 표현식을 사용할 수 있다. 
- 표현식을 정의하는 문법은 `#{ <expression string> }` 이다.
    - '#' 는 SpEL 의 표현식의 시작을 나타낸다. 즉, 표현식을 감싸는 역할
- application context 의 모든 빈은 미리 일반적인 이름으로 정의되어 있어 참조할 수 있다.
    - 표준 컨텍스트 빈인 environment 와 런타임에 접근 가능한 systemProperties, systemEnvironment 가 있다.
- 기본값을 지정하기 위해선 `@Value` 어노테이션을 필드, 메서드, 메서드/생성자 파라미터에 붙이면 된다.

아래는 필드의 기본값을 설정한다.
```java
public class FieldValueTestBean {

	@Value("#{ systemProperties['user.region'] }")
	private String defaultLocale;

	public void setDefaultLocale(String defaultLocale) {
		this.defaultLocale = defaultLocale;
	}

	public String getDefaultLocale() {
		return this.defaultLocale;
	}
}
```
- 미리 정의된 항목은 # 접두어 없이 바로 사용할 수 있다.
- 여기서 `#` 은 SpEL 표현식을 시작할 때 #{expression} 에서 쓰는 것과 다르다.
- 여기서 `#` 은 #varName 처럼 표현식 안에서 변수를 가리킬 때 쓰는 변수 접두어이다.
- 약간의 코드 해석?
    - systemProperties: 스프링이 미리 정의된 빈으로 제공하는 jvm 시스템 프로퍼티 맵 객체이다.
    - systemProperties 맵 객체에서 'user.region' 이라는 키로 값을 꺼낸다.
    - 즉, System.getProperties("user.region") 과 같음

다음은 setter 에 적용한 예제이다.
```java
public class PropertyValueTestBean {

	private String defaultLocale;

	@Value("#{ systemProperties['user.region'] }")
	public void setDefaultLocale(String defaultLocale) {
		this.defaultLocale = defaultLocale;
	}

	public String getDefaultLocale() {
		return this.defaultLocale;
	}
}
```

@Autowired 가 붙은 메서드/생성자도 @Value 를 함께 사용할 수 있다.
```java
public class SimpleMovieLister {

	private MovieFinder movieFinder;
	private String defaultLocale;

	@Autowired
	public void configure(MovieFinder movieFinder,
			@Value("#{ systemProperties['user.region'] }") String defaultLocale) {
		this.movieFinder = movieFinder;
		this.defaultLocale = defaultLocale;
	}

	// ...
}
```
```java
public class MovieRecommender {

	private String defaultLocale;

	private CustomerPreferenceDao customerPreferenceDao;
    
    // 생성자에 적용
	public MovieRecommender(CustomerPreferenceDao customerPreferenceDao,
			@Value("#{systemProperties['user.country']}") String defaultLocale) {
		this.customerPreferenceDao = customerPreferenceDao;
		this.defaultLocale = defaultLocale;
	}

	// ...
}
```

또한 다른 빈의 프로퍼티를 이름으로 참조할 수 있다.
```java
public class ShapeGuess {

	private double initialShapeSeed;

	@Value("#{ numberGuess.randomNumber }")
	public void setInitialShapeSeed(double initialShapeSeed) {
		this.initialShapeSeed = initialShapeSeed;
	}

	public double getInitialShapeSeed() {
		return initialShapeSeed;
	}
}
```